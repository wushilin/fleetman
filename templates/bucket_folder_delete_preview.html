{% extends "base.html" %}

{% block title %}Delete Folder - Fleetman{% endblock %}
{% block nav_buckets %}active{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <h1 class="mb-1">Delete Folder</h1>
        <div class="text-muted">
            <strong>{{ bucket_display }}</strong> â†’ <code>{{ bucket_name }}</code>
        </div>
    </div>
    <form method="get" action="/buckets/manage" class="d-inline">
        <input type="hidden" name="name" value="{{ bucket_display }}">
        <input type="hidden" name="prefix" value="{{ return_prefix }}">
        <button class="btn btn-outline-secondary" type="submit">
            <i class="bi bi-arrow-left"></i> Back
        </button>
    </form>
</div>

{% if error.is_some() %}
<div class="alert alert-danger">
    <i class="bi bi-exclamation-triangle"></i> {{ error.as_ref().unwrap() }}
</div>
{% endif %}

<div class="card">
    <div class="card-header">
        <i class="bi bi-folder-x"></i> Confirm deletion
    </div>
    <div class="card-body">
        <div class="mb-2">
            Folder prefix:
            <div><code>{{ folder_prefix }}</code></div>
        </div>
        <div class="mb-3">
            Objects to delete: <strong>{{ object_count }}</strong>
        </div>

        {% if sample_keys.len() > 0 %}
        <div class="mb-3">
            <div class="small text-muted mb-1">Sample keys</div>
            <ul class="small mb-0">
                {% for k in sample_keys %}
                <li><code>{{ k }}</code></li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <form method="post" action="/buckets/folder/delete">
            <input type="hidden" name="name" value="{{ bucket_display }}">
            <input type="hidden" name="folder_prefix" value="{{ folder_prefix }}">
            <input type="hidden" name="return_prefix" value="{{ return_prefix }}">
            <button type="submit" class="btn btn-danger" {% if object_count == 0 %}disabled{% endif %}
                    onclick="return confirm('Delete this folder and all objects under it?\n\n{{ folder_prefix }}');">
                <i class="bi bi-trash"></i> Delete Folder
            </button>
        </form>
    </div>
</div>
{% endblock %}


